{"version":3,"file":"utm-aska.min.js","sources":["../src/defaultUtmKeys.js","../src/getUtmFromUrl/getUrmFromUrl.js","../node_modules/js-cookie/dist/js.cookie.mjs","../src/getCookieByName/getCookieByName.js","../src/getUtmFromCookies/getUtmFromCookies.js","../src/getUtmParams/getUtmParams.js"],"sourcesContent":["/**\r\n * Default utm keys\r\n * @type {string[]}\r\n */\r\nconst defaultUtmKeys =  [\r\n    'utm_source',\r\n    'utm_medium',\r\n    'utm_campaign',\r\n    'utm_term',\r\n    'utm_content',\r\n]\r\n\r\nexport { defaultUtmKeys }","import { defaultUtmKeys as defaultImportedKeys } from \"../defaultUtmKeys\"\r\n\r\n/**\r\n * Get utm tags from url\r\n * @param url\r\n * @param utmKeysMap\r\n * @returns {{}}\r\n */\r\nexport default function getUtmFromUrl(url, utmKeysMap = []) {\r\n\r\n    let utmKeys = [...defaultImportedKeys, ...utmKeysMap]\r\n    utmKeys = [...new Set(utmKeys)]\r\n\r\n    let queryString = url\r\n        ? url.split('?')[1]\r\n        : window.location.search.slice(1)\r\n    const obj = {}\r\n\r\n    if (queryString) {\r\n        queryString = queryString.split('#')[0]\r\n        const arr = queryString.split('&')\r\n\r\n        for (let i = 0; i < arr.length; i++) {\r\n            const a = arr[i].split('=')\r\n            let paramName = a[0]\r\n            if (utmKeys.includes(paramName)) {\r\n                let paramValue = typeof a[1] === 'undefined' ? true : a[1]\r\n\r\n                paramName = paramName.toLowerCase()\r\n                if (typeof paramValue === 'string')\r\n                    paramValue = paramValue.toLowerCase()\r\n\r\n                if (paramName.match(/\\[(\\d+)?]$/)) {\r\n                    const key = paramName.replace(/\\[(\\d+)?]/, '')\r\n                    if (!obj[key]) obj[key] = []\r\n\r\n                    if (paramName.match(/\\[\\d+]$/)) {\r\n                        const index = /\\[(\\d+)]/.exec(paramName)[1]\r\n                        obj[key][index] = paramValue\r\n                    } else {\r\n                        obj[key].push(paramValue)\r\n                    }\r\n                } else if (!obj[paramName]) {\r\n                    obj[paramName] = paramValue\r\n                } else if (obj[paramName] && typeof obj[paramName] === 'string') {\r\n                    obj[paramName] = [obj[paramName]]\r\n                    obj[paramName].push(paramValue)\r\n                } else {\r\n                    obj[paramName].push(paramValue)\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    return obj\r\n}","/*! js-cookie v3.0.1 | MIT */\n/* eslint-disable no-var */\nfunction assign (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n    for (var key in source) {\n      target[key] = source[key];\n    }\n  }\n  return target\n}\n/* eslint-enable no-var */\n\n/* eslint-disable no-var */\nvar defaultConverter = {\n  read: function (value) {\n    if (value[0] === '\"') {\n      value = value.slice(1, -1);\n    }\n    return value.replace(/(%[\\dA-F]{2})+/gi, decodeURIComponent)\n  },\n  write: function (value) {\n    return encodeURIComponent(value).replace(\n      /%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,\n      decodeURIComponent\n    )\n  }\n};\n/* eslint-enable no-var */\n\n/* eslint-disable no-var */\n\nfunction init (converter, defaultAttributes) {\n  function set (key, value, attributes) {\n    if (typeof document === 'undefined') {\n      return\n    }\n\n    attributes = assign({}, defaultAttributes, attributes);\n\n    if (typeof attributes.expires === 'number') {\n      attributes.expires = new Date(Date.now() + attributes.expires * 864e5);\n    }\n    if (attributes.expires) {\n      attributes.expires = attributes.expires.toUTCString();\n    }\n\n    key = encodeURIComponent(key)\n      .replace(/%(2[346B]|5E|60|7C)/g, decodeURIComponent)\n      .replace(/[()]/g, escape);\n\n    var stringifiedAttributes = '';\n    for (var attributeName in attributes) {\n      if (!attributes[attributeName]) {\n        continue\n      }\n\n      stringifiedAttributes += '; ' + attributeName;\n\n      if (attributes[attributeName] === true) {\n        continue\n      }\n\n      // Considers RFC 6265 section 5.2:\n      // ...\n      // 3.  If the remaining unparsed-attributes contains a %x3B (\";\")\n      //     character:\n      // Consume the characters of the unparsed-attributes up to,\n      // not including, the first %x3B (\";\") character.\n      // ...\n      stringifiedAttributes += '=' + attributes[attributeName].split(';')[0];\n    }\n\n    return (document.cookie =\n      key + '=' + converter.write(value, key) + stringifiedAttributes)\n  }\n\n  function get (key) {\n    if (typeof document === 'undefined' || (arguments.length && !key)) {\n      return\n    }\n\n    // To prevent the for loop in the first place assign an empty array\n    // in case there are no cookies at all.\n    var cookies = document.cookie ? document.cookie.split('; ') : [];\n    var jar = {};\n    for (var i = 0; i < cookies.length; i++) {\n      var parts = cookies[i].split('=');\n      var value = parts.slice(1).join('=');\n\n      try {\n        var foundKey = decodeURIComponent(parts[0]);\n        jar[foundKey] = converter.read(value, foundKey);\n\n        if (key === foundKey) {\n          break\n        }\n      } catch (e) {}\n    }\n\n    return key ? jar[key] : jar\n  }\n\n  return Object.create(\n    {\n      set: set,\n      get: get,\n      remove: function (key, attributes) {\n        set(\n          key,\n          '',\n          assign({}, attributes, {\n            expires: -1\n          })\n        );\n      },\n      withAttributes: function (attributes) {\n        return init(this.converter, assign({}, this.attributes, attributes))\n      },\n      withConverter: function (converter) {\n        return init(assign({}, this.converter, converter), this.attributes)\n      }\n    },\n    {\n      attributes: { value: Object.freeze(defaultAttributes) },\n      converter: { value: Object.freeze(converter) }\n    }\n  )\n}\n\nvar api = init(defaultConverter, { path: '/' });\n/* eslint-enable no-var */\n\nexport default api;\n","/**\r\n * Get cookie value by name\r\n * @param name\r\n * @returns {any}\r\n */\r\nimport Cookies from 'js-cookie'\r\nexport default function getCookieByName(name) {\r\n    if (Cookies.get(name)) {\r\n        return JSON.parse(Cookies.get(name))\r\n    }\r\n    return null\r\n}","import { defaultUtmKeys as defaultImportedKeys } from \"../defaultUtmKeys\"\r\nimport Cookies from 'js-cookie'\r\n\r\n/**\r\n * Get utm tags from cookies\r\n * @param utmKeysMap\r\n * @returns {{}}\r\n */\r\nexport default function getUtmFromCookies(utmKeysMap = []) {\r\n    let utmKeys = [...defaultImportedKeys, ...utmKeysMap]\r\n    utmKeys = [...new Set(utmKeys)]\r\n\r\n    const allCookies = Cookies.get()\r\n    const utmCookies = {}\r\n    Object.keys(allCookies).forEach(cookie => {\r\n        if (utmKeys.includes(cookie)) {\r\n            utmCookies[cookie] = allCookies[cookie]\r\n        }\r\n    })\r\n    return utmCookies\r\n}","import getUtmFromUrl from \"../getUtmFromUrl\";\r\nimport getCookieByName from \"../getCookieByName\";\r\nimport getUtmFromCookies from \"../getUtmFromCookies\";\r\nimport { defaultUtmKeys as defaultImportedKeys } from \"../defaultUtmKeys\"\r\n\r\n/**\r\n * Get all utm keys from url or cookies\r\n * @param utmKeysMap\r\n * @returns {{}}\r\n */\r\nexport default function getUtmParams(utmKeysMap = []) {\r\n\r\n    let utmKeys = [...defaultImportedKeys, ...utmKeysMap]\r\n    utmKeys = [...new Set(utmKeys)]\r\n\r\n    let utmParamsObject\r\n\r\n    utmParamsObject = getUtmFromUrl(window.location.href, utmKeys)\r\n    if (utmParamsObject && Object.keys(utmParamsObject).length === 0) {\r\n        utmParamsObject = getUtmFromCookies(utmKeys)\r\n        if (Object.keys(utmParamsObject).length === 0) {\r\n            utmParamsObject = getCookieByName('utm')\r\n        }\r\n    }\r\n\r\n    return utmParamsObject\r\n}"],"names":["defaultUtmKeys","getUtmFromUrl","url","utmKeysMap","utmKeys","defaultImportedKeys","Set","queryString","split","window","location","search","slice","obj","arr","i","length","a","paramName","includes","paramValue","toLowerCase","match","key","replace","index","exec","push","assign","target","arguments","source","api","init","converter","defaultAttributes","set","value","attributes","document","expires","Date","now","toUTCString","encodeURIComponent","decodeURIComponent","escape","stringifiedAttributes","attributeName","cookie","write","Object","create","get","cookies","jar","parts","join","foundKey","read","e","remove","withAttributes","this","withConverter","freeze","path","getCookieByName","name","Cookies","JSON","parse","getUtmFromCookies","allCookies","utmCookies","keys","forEach","utmParamsObject","href"],"mappings":"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"}